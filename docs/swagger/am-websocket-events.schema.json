{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://developer.husqvarnagroup.cloud/schemas/automower-websocket-events.json",
  "title": "Husqvarna AutomowerÂ® Connect WebSocket Events",
  "description": "Schema for all Automower Connect WebSocket events (v1.0.0)",
  "type": "object",
  "oneOf": [
    { "$ref": "#/definitions/connection-event" },
    { "$ref": "#/definitions/battery-event-v2" },
    { "$ref": "#/definitions/calendar-event-v2" },
    { "$ref": "#/definitions/cuttingHeight-event-v2" },
    { "$ref": "#/definitions/headlights-event-v2" },
    { "$ref": "#/definitions/message-event-v2" },
    { "$ref": "#/definitions/mower-event-v2" },
    { "$ref": "#/definitions/planner-event-v2" },
    { "$ref": "#/definitions/position-event-v2" }
  ],
  "definitions": {
    "connection-event": {
      "title": "Connection Event",
      "type": "object",
      "properties": {
        "ready": { "type": "boolean", "description": "True if the connection is ready to receive events." },
        "connectionId": { "type": "string", "description": "Generated by the server when the connection is established." }
      },
      "required": ["ready", "connectionId"]
    },
    "battery-event-v2": {
      "title": "Battery Event",
      "type": "object",
      "properties": {
        "id": { "type": "string", "description": "Mower ID" },
        "type": { "const": "battery-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "battery": {
              "type": "object",
              "properties": {
                "batteryPercent": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 100,
                  "description": "Battery level in percent."
                }
              },
              "required": ["batteryPercent"]
            }
          },
          "required": ["battery"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "calendar-event-v2": {
      "title": "Calendar Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "calendar-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "calendar": {
              "type": "object",
              "properties": {
                "tasks": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "start": { "type": "number", "description": "Start time in minutes." },
                      "duration": { "type": "number", "description": "Duration of task in minutes." },
                      "workAreaId": { "type": "number", "description": "Work area ID (optional)." },
                      "monday": { "type": "boolean" },
                      "tuesday": { "type": "boolean" },
                      "wednesday": { "type": "boolean" },
                      "thursday": { "type": "boolean" },
                      "friday": { "type": "boolean" },
                      "saturday": { "type": "boolean" },
                      "sunday": { "type": "boolean" }
                    },
                    "required": ["start", "duration"]
                  }
                }
              },
              "required": ["tasks"]
            }
          },
          "required": ["calendar"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "cuttingHeight-event-v2": {
      "title": "Cutting Height Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "cuttingHeight-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "cuttingHeight": {
              "type": "object",
              "properties": {
                "height": { "type": "number", "minimum": 1, "maximum": 9, "description": "Cutting height 1-9." }
              },
              "required": ["height"]
            }
          },
          "required": ["cuttingHeight"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "headlights-event-v2": {
      "title": "Headlights Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "headlights-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "headlight": {
              "type": "object",
              "properties": {
                "mode": {
                  "type": "string",
                  "enum": ["ALWAYS_ON", "ALWAYS_OFF", "EVENING_ONLY", "EVENING_AND_NIGHT"],
                  "description": "Headlight mode."
                }
              },
              "required": ["mode"]
            }
          },
          "required": ["headlight"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "message-event-v2": {
      "title": "Message Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "message-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "message": {
              "type": "object",
              "properties": {
                "time": { "type": "number", "description": "Local timestamp (epoch seconds)." },
                "code": { "type": "number", "description": "Message code (see status codes)." },
                "severity": {
                  "type": "string",
                  "enum": ["FATAL", "ERROR", "WARNING", "INFO", "DEBUG", "SW", "UNKNOWN"]
                },
                "latitude": { "type": "number", "minimum": -90, "maximum": 90 },
                "longitude": { "type": "number", "minimum": -180, "maximum": 180 }
              },
              "required": ["time", "code", "severity"]
            }
          },
          "required": ["message"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "mower-event-v2": {
      "title": "Mower Status Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "mower-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "mower": {
              "type": "object",
              "properties": {
                "mode": {
                  "type": "string",
                  "enum": ["MAIN_AREA", "SECONDARY_AREA", "HOME", "DEMO", "UNKNOWN", "POI"]
                },
                "activity": {
                  "type": "string",
                  "enum": [
                    "UNKNOWN",
                    "NOT_APPLICABLE",
                    "MOWING",
                    "GOING_HOME",
                    "CHARGING",
                    "LEAVING",
                    "PARKED_IN_CS",
                    "STOPPED_IN_GARDEN"
                  ]
                },
                "inactiveReason": {
                  "type": "string",
                  "enum": ["NONE", "PLANNING", "SEARCHING_FOR_SATELLITES"]
                },
                "state": {
                  "type": "string",
                  "enum": [
                    "UNKNOWN",
                    "PAUSED",
                    "IN_OPERATION",
                    "WAIT_UPDATING",
                    "WAIT_POWER_UP",
                    "RESTRICTED",
                    "OFF",
                    "STOPPED",
                    "ERROR",
                    "FATAL_ERROR",
                    "ERROR_AT_POWER_UP"
                  ]
                },
                "errorCode": { "type": "integer", "minimum": 0, "maximum": 724 },
                "isErrorConfirmable": { "type": "boolean" },
                "errorCodeTimestamp": { "type": "integer", "minimum": 0 },
                "workAreaId": { "type": "integer" }
              }
            }
          },
          "required": ["mower"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "planner-event-v2": {
      "title": "Planner Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "planner-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "planner": {
              "type": "object",
              "properties": {
                "nextStartTimestamp": { "type": "integer", "minimum": 0 },
                "override": {
                  "type": "object",
                  "properties": {
                    "action": {
                      "type": "string",
                      "enum": ["NOT_ACTIVE", "FORCE_PARK", "FORCE_MOW"]
                    }
                  }
                },
                "restrictedReason": {
                  "type": "string",
                  "enum": [
                    "NONE",
                    "WEEK_SCHEDULE",
                    "PARK_OVERRIDE",
                    "SENSOR",
                    "DAILY_LIMIT",
                    "FOTA",
                    "FROST",
                    "ALL_WORK_AREAS_COMPLETED",
                    "EXTERNAL"
                  ]
                },
                "externalReason": { "type": "integer" }
              }
            }
          },
          "required": ["planner"]
        }
      },
      "required": ["id", "type", "attributes"]
    },
    "position-event-v2": {
      "title": "Position Event",
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "type": { "const": "position-event-v2" },
        "attributes": {
          "type": "object",
          "properties": {
            "position": {
              "type": "object",
              "properties": {
                "latitude": { "type": "number", "minimum": -90, "maximum": 90 },
                "longitude": { "type": "number", "minimum": -180, "maximum": 180 }
              },
              "required": ["latitude", "longitude"]
            }
          },
          "required": ["position"]
        }
      },
      "required": ["id", "type", "attributes"]
    }
  }
}
